---
id: 492
title: Write a program to perform CRUD operations using JDBC.
date: 2020-10-08T05:35:00+00:00
author: kaustubh
layout: post
guid: https://blog.kaustubh.codes/write-a-program-to-perform-crud-operations-using-jdbc/
permalink: /write-a-program-to-perform-crud-operations-using-jdbc/
rank_math_internal_links_processed:
  - "1"
blogger_blog:
  - swayalgo.com
blogger_author:
  - Kaustubh Kulkarni
blogger_permalink:
  - /2020/10/write-program-to-perform-crud.html
blogger_internal:
  - /feeds/8126989156179907512/posts/default/3619922181977290190
rank_math_analytic_object_id:
  - "95"
categories:
  - Java
  - JDBC
---
&nbsp;/**

* Q ) Write a program to perform CRUD operations using JDBC.

*/

<pre>import java.sql.*;<br />import java.util.Scanner;<br />public class assign2 {<br /><br />public static void main(String[] args) {<br />Connection con = null;<br />Scanner sc = new Scanner(System.in);<br />try {<br />/**<br />* Need to execute first export CLASSPATH=$CLASSPATH:mysql-connector-java-8.0.21.jar<br />*/<br />con = DriverManager.getConnection("jdbc:mysql://localhost:3306/kaustubh?<br />allowPublicKeyRetrieval=true&useSSL=false", "kaustubh",<br />"kaustubh");<br />// connection TEST<br />System.out.println("Connection is successful !!!!!");<br />// Create table if does not exists<br />String CREATE_TABLE_SQL = "CREATE TABLE IF NOT EXISTS kaustubh.student (" + "id INT,"<br />+ "sname VARCHAR(30), " + "sclass VARCHAR(30)," + "PRIMARY KEY (id))";<br />// end create table if does not exists<br />Statement stmt = con.createStatement();<br />stmt.executeUpdate(CREATE_TABLE_SQL);<br />System.out.println("Table created");<br />// Some initial fixed insertion queries<br />insert(con, 1, "Kaustubh", "MCA II");<br />insert(con, 2, "Angad", "MCA II");<br />insert(con, 3, "Sagar", "MCA III");<br />insert(con, 4, "Rajesh", "MCA II");<br />// Some initial fixed insertion queries<br />selection(con, sc, stmt);<br /><br />} catch (Exception e) {<br />e.printStackTrace();<br />}<br />}<br />static void selection(Connection con, Scanner sc, Statement stmt) {<br />System.out<br />.println("Select Operation to Perform :n1.Insertn2.Updaten3.Deleten4.Selectn5.Drop Table<br />n6.Exit");<br />int choice = sc.nextInt();<br />switch (choice) {<br />case 1:<br />System.out.println("Enter Student id ,Student Name & Student Class");<br />int id=sc.nextInt();<br />sc.nextLine();<br />String sname=sc.nextLine();<br />String sclass=sc.nextLine();<br />insert(con, id, sname, sclass);<br />selection(con, sc, stmt);<br />break;<br />case 2:<br />System.out.println("Enter ID to Update & new Class");<br />int sid=sc.nextInt();<br />sc.nextLine();<br />String ssclass=sc.nextLine();<br />updateData(con, sid, ssclass);<br />selection(con, sc, stmt);<br />break;<br /><br />case 3:<br />System.out.println("Enter ID to Delete");<br />delete(con, sc.nextInt());<br />selection(con, sc, stmt);<br />break;<br /><br />case 4:<br />showData(con);<br />selection(con, sc, stmt);<br />break;<br /><br />case 5:<br />try {<br /><br />stmt.executeUpdate("DELETE from student");<br />System.out.println("Student Table DROPPED . Program needs to restart to fire initial queries");<br />sc.close();<br />con.close();<br />} catch (SQLException e) {<br />e.printStackTrace();<br />}<br />break;<br /><br />case 6: System.exit(0);<br />break;<br /><br />default:System.out.println("The option you selected was invalidnPlease try again?");<br />selection(con, sc,stmt);<br />break;<br /><br />}<br /><br />}<br />static void insert(Connection con,Integer sid,String name, String ssclass){<br />try {<br />String sql = "INSERT INTO student (id, sname, sclass) VALUES (?, ?, ?)";<br />PreparedStatement statement = con.prepareStatement(sql);<br />statement.setInt(1, sid);<br />statement.setString(2, name);<br />statement.setString(3, ssclass);<br />int rowsInserted = statement.executeUpdate();<br />if (rowsInserted &gt; 0) {<br />System.out.println("A new student was inserted successfully!");<br />}<br />} catch (Exception e) {<br />e.printStackTrace();<br />}<br />}<br />static void showData(Connection con) {<br />try {<br />String selectSql = "SELECT * FROM student";<br /><br />Statement selectStatement = con.createStatement();<br />ResultSet result = selectStatement.executeQuery(selectSql);<br />int count = 0;<br />while (result.next()) {<br />String id = result.getString("id");<br />String sname = result.getString("sname");<br />String sclass = result.getString("sclass");<br />String output = "Student #%d: %s - %s - %s";<br />System.out.println(String.format(output, ++count, id, sname, sclass));<br />}<br />} catch (Exception e) {<br />e.printStackTrace();<br />}<br />}<br />static void updateData(Connection con,Integer id,String sclass) {<br />try {<br />String updateSql = "UPDATE student SET sclass=? WHERE id=?";<br />PreparedStatement updateStatement = con.prepareStatement(updateSql);<br />updateStatement.setString(1, "MCA I");<br />updateStatement.setInt(2, 4);<br />int rowsUpdated = updateStatement.executeUpdate();<br />if (rowsUpdated &gt; 0) {<br />System.out.println("An existing student was updated successfully!");<br />}<br />} catch (Exception e) {<br />e.printStackTrace();<br />}<br />}<br /><br />static void delete(Connection con,Integer sid)<br />{<br />try {<br />String deleteSql = "DELETE FROM student WHERE id=?";<br />PreparedStatement deletestatement = con.prepareStatement(deleteSql);<br />deletestatement.setInt(1, sid);<br />int rowsDeleted = deletestatement.executeUpdate();<br />if (rowsDeleted &gt; 0) {<br />System.out.println("A Student was deleted successfully!");<br />}<br />} catch (Exception e) {<br />e.printStackTrace();<br />}<br />}<br /><br />}<br /></pre>

Output 

<pre>kaustubh@kaustubh-Lenovo-G50-80:/media/kaustubh/A/Practicals/<br />practicals/MCA/SEM III/JAVA/Practicals/assignment no7$ javac<br />assign2.java<br />kaustubh@kaustubh-Lenovo-G50-80:/media/kaustubh/A/Practicals/<br />practicals/MCA/SEM III/JAVA/Practicals/assignment no7$ java<br />assign2<br />Connection is successful !!!!!<br />Table created<br />A new student was inserted successfully!<br />A new student was inserted successfully!<br />A new student was inserted successfully!<br />A new student was inserted successfully!<br />Select Operation to Perform :<br />1.Insert<br />2.Update<br />3.Delete<br />4.Select<br />5.Drop Table<br />6.Exit<br />4<br />Student #1: 1 - Kaustubh - MCA II<br />Student #2: 2 - Angad - MCA II<br />Student #3: 3 - Sagar - MCA III<br />Student #4: 4 - Rajesh - MCA II<br />Select Operation to Perform :<br />1.Insert<br />2.Update<br />3.Delete<br />4.Select<br />5.Drop Table<br />6.Exit<br />1<br />Enter Student id ,Student Name & Student Class<br />5<br />Manoj<br />MCA III<br />A new student was inserted successfully!<br />Select Operation to Perform :<br />1.Insert<br />2.Update<br />3.Delete<br />4.Select<br />5.Drop Table<br />6.Exit<br />4<br />Student #1: 1 - Kaustubh - MCA II<br />Student #2: 2 - Angad - MCA II<br />Student #3: 3 - Sagar - MCA III<br />Student #4: 4 - Rajesh - MCA II<br /><br />Student #5: 5 - Manoj - MCA III<br />Select Operation to Perform :<br />1.Insert<br />2.Update<br />3.Delete<br />4.Select<br />5.Drop Table<br />6.Exit<br />2<br />Enter ID to Update & new Class<br />5<br />MCAII<br />An existing student was updated successfully!<br />Select Operation to Perform :<br />1.Insert<br />2.Update<br />3.Delete<br />4.Select<br />5.Drop Table<br />6.Exit<br />4<br />Student #1: 1 - Kaustubh - MCA II<br />Student #2: 2 - Angad - MCA II<br />Student #3: 3 - Sagar - MCA III<br />Student #4: 4 - Rajesh - MCA I<br />Student #5: 5 - Manoj - MCA III<br />Select Operation to Perform :<br />1.Insert<br />2.Update<br />3.Delete<br />4.Select<br />5.Drop Table<br />6.Exit<br />3<br />Enter ID to Delete<br />5<br />A Student was deleted successfully!<br />Select Operation to Perform :<br />1.Insert<br />2.Update<br />3.Delete<br />4.Select<br />5.Drop Table<br />6.Exit<br />4<br />Student #1: 1 - Kaustubh - MCA II<br />Student #2: 2 - Angad - MCA II<br />Student #3: 3 - Sagar - MCA III<br />Student #4: 4 - Rajesh - MCA I<br />Select Operation to Perform :<br />1.Insert<br />2.Update<br /><br />3.Delete<br />4.Select<br />5.Drop Table<br />6.Exit<br />5<br />Student Table DROPPED . Program needs to restart to fire initial<br />queries<br /><br /></pre>